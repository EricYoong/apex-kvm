<html>

<head>
    <title>configuration</title>

    <link rel="shortcut icon" href="">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>
    <script defer src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script defer src="https://cdn.jsdelivr.net/npm/spectrum-colorpicker2/dist/spectrum.min.js"></script>
    <link rel="stylesheet" type="text/css"
        href="https://cdn.jsdelivr.net/npm/spectrum-colorpicker2/dist/spectrum.min.css">
    <link rel="stylesheet" type="text/css" href=/menu/resources/main.css>
</head>

<body onload="onLoad();">
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto nav-pills">
                <li class="nav-item active" id="aimbotTab" onclick="changeTab(1)">
                    <a class="nav-link" href="#aim">aimbot <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item" id="espTab" onclick="changeTab(2)">
                    <a class="nav-link" href="#esp">esp</a>
                </li>
                <li class="nav-item" id="miscTab" onclick="changeTab(3)">
                    <a class="nav-link" href="#misc">misc</a>
                </li>
            </ul>
        </div>
    </nav>
    <main role="main" class="container" style="margin-left: 1rem;">
        <div id="aim" style='display:inline;'>
            <input type="checkbox" id="aimbotEnabled" name="aimbotEnabled"
                onchange="changed('checkbox', 'aimbot.enabled', this.checked)">
            <label for="aimbotEnabled">enabled</label><br>

            <select id="aimbotKey" onchange="changed('value', 'aimbot.key', this.value)" class="optKeys"></select>
            <label for="aimbotKey">key</label><br>

            <input type="checkbox" id="aimbotRcsEnabled" name="aimbotRcsEnabled"
                onchange="changed('checkbox', 'aimbot.rcs_enabled', this.checked)">
            <label for="aimbotRcsEnabled">recoil control system</label><br>

            <hr>
            <input type="range" id="aimbotFov" name="aimbotFov" min="0" max="180"
                onchange="changed('value', 'aimbot.fov', this.value)" oninput="(fovNr.value=`${this.value} deg`)">
            <label for="aimbotFovLabel">fov</label>
            <input type="text" id="fovNr" value="0" class="slider-value"><br>

            <input type="range" id="aimbotMaxDistance" name="aimbotMaxDistance" min="1" max="500"
                onchange="changed('value', 'aimbot.maximum_distance', this.value)"
                oninput="(aimMaxDistNr.value=`${this.value} m`)">
            <label for="aimbotMaxDistance">maximum distance</label>
            <input type="text" id="aimMaxDistNr" value="0" class="slider-value">

            <br>
            <input type="checkbox" id="aimbotSmooth" name="aimbotSmooth"
                onchange="changed('checkbox', 'aimbot.smooth', this.checked)">
            <label for="aimbotSmooth">smooth</label><br>

            <input type="range" id="aimbotSmoothFactor" name="aimbotSmoothFactor" min="1" max="100"
                onchange="changed('value', 'aimbot.smooth_factor', this.value)"
                oninput="(smoothFactorNr.value=this.value)">
            <label for="aimbotSmoothLabel">smooth factor</label>
            <input type="text" id="smoothFactorNr" value="0" class="slider-value">
            <br>

            <input type="checkbox" id="aimbotOnFriends" name="aimbotOnFriends"
                onchange="changed('checkbox', 'aimbot.aim_on_friends', this.checked)">
            <label for="aimbotOnFriends">aim on friends</label><br>

            <input type="checkbox" id="aimbotOnDummies"
                onchange="changed('checkbox', 'aimbot.aim_on_dummies', this.checked)">
            <label for="aimbotOnDummies" data-toggle="tooltip" data-placement="top" title="firing range only">aim on
                dummies</label><br>

            <input type="checkbox" id="aimbotTargetLock"
                onchange="changed('checkbox', 'aimbot.target_lock', this.checked)">
            <label for="aimbotTargetLock" data-toggle="tooltip" data-placement="top"
                title="only changes targets if it's not valid anymore">target lock</label><br>

            <input type="checkbox" id="aimbotVisCheck" onchange="changed('checkbox', 'aimbot.vis_check', this.checked)">
            <label for="aimbotVisCheck">visibility check</label><br>

            <input type="checkbox" id="aimbotRandomAimSpot"
                onchange="changed('checkbox', 'aimbot.random_aim_spot', this.checked)">
            <label for="aimbotRandomAimSpot" data-toggle="tooltip" data-placement="top"
                title="randomize positions between a single hitbox">random aim spot</label><br>

            <input type="checkbox" id="aimbotSelectionSwitchOnKey"
                onchange="changed('checkbox', 'aimbot.target_selection_switch_on_key', this.checked)">
            <label for="aimbotSelectionSwitchOnKey">change selection algorithm on key press</label><br>

            <select id="aimbotSelectionSwitchKey" class="optKeys"
                onchange="changed('value', 'aimbot.target_selection_key', this.value)"></select>
            <label for="aimbotSelectionSwitchKey">algorithm switch on key</label><br>

            <hr>

            <select id="aimbotPrimaryHitbox" class="optHitboxes"
                onchange="changed('value', 'aimbot.primary_hitbox', this.value)"></select>
            <label for="aimbotPrimaryHitbox">primary hitbox</label><br>

            <select id="aimbotSecondaryHitboxKey" class="optKeys"
                onchange="changed('value', 'aimbot.secondary_hitbox_key', this.value)"></select>
            <label for="aimbotSecondaryHitboxKey">secondary hitbox key</label><br>

            <select id="aimbotSecondaryHitbox" class="optHitboxes"
                onchange="changed('value', 'aimbot.secondary_hitbox', this.value)"></select>
            <label for="aimbotSecondaryHitbox">secondary hitbox</label><br>
        </div>

        <div id="esp" style='display:none;'>
            <input type="checkbox" id="visualEnabled" name="visualEnabled"
                onchange="changed('checkbox', 'visual.enabled', this.checked)">
            <label for="visualEnabled">enabled</label><br>

            <input type="checkbox" id="visualItemEsp" name="visualItemEsp"
                onchange="changed('checkbox', 'visual.item_esp', this.checked)">
            <label for="visualItemEsp">item esp</label><br>

            <input type="checkbox" id="visualHighlight" onchange="changed('checkbox', 'visual.glow_esp', this.checked)">
            <label for="visualHighlight">glow</label><br>

            <hr>

            <input type="checkbox" id="visualHighlightAimTarget"
                onchange="changed('checkbox', 'visual.aim_target_esp', this.checked)">
            <label for="visualHighlightAimTarget">highlight aim target</label><br>


            <input type="checkbox" id="visualHighlightFriends"
                onchange="changed('checkbox', 'visual.highlight_friends', this.checked)">
            <label for="visualHighlightFriends">highlight friends</label><br>

            <hr>
            <input type="checkbox" id="visualColoredHealth"
                onchange="changed('checkbox', 'visual.color_health_based', this.checked)">
            <label for="visualColoredHealth">color based on health</label><br>

            <input type="range" id="visualHealthBasedAlpha" name="visualHealthBasedAlpha" min="1" max="100"
                onchange="changed('value', 'visual.health_based_alpha', (this.value / 100).toFixed())"
                oninput="(visualHealthAlphaNr.value=this.value)">
            <label for="visualHealthAlphaLabel">glow transparency on health</label>
            <input type="text" id="visualHealthAlphaNr" value="0" min=0 max=100 class="slider-value"> <br>

            <input id="visualEspColor" onchange="changed('visual.esp_color', 'visualEspColor')">
            <label for="visualEspColor">esp color</label>
            <br>

            <input id="visualTargetColor"
                onchange="changed('color', 'visual.aimbot_target_color', 'visualTargetColor')">
            <label for="visualTargetColor">aim target color</label>
            <br>

            <input id="visualDownedColor" onchange="changed('color', 'visual.downed_color', 'visualDownedColor')">
            <label for="visualDownedColor">downed color</label>
            <br>

            <input id="visualFriendColor" onchange="changed('color', 'visual.friend_color', 'visualFriendColor')">
            <label for="visualFriendColor">friend color</label>
            <br>
        </div>
        <div id="misc" style='display:none;'>
        </div>
        <hr>
        <button type="button" class="btn btn-primary" onclick="onSaveLoad('save')">save</button>
        <button type="button" class="btn btn-secondary" onclick="onSaveLoad('load')">load</button>
    </main>

    <script>
        $(document).ready(function () {
            var keys = {
                o1: { value: 1, text: "mouse 1" },
                o2: { value: 2, text: "mouse 2" },
                o3: { value: 4, text: "mouse 3" },
                o4: { value: 5, text: "xbutton 1" },
                o5: { value: 6, text: "xbutton 2" },
                o6: { value: 16, text: "shift" },
                o7: { value: 18, text: "alt" },
                o8: { value: 9, text: "tab" },
                o9: { value: 32, text: "space" },
                o10: { value: 45, text: "insert" },
            }

            var hitboxes = {
                o1: { value: 10, text: "head" },
                o2: { value: 9, text: "upper neck" },
                o3: { value: 8, text: "neck" },
                o4: { value: 7, text: "spine c" },
                o5: { value: 6, text: "spine b" },
                o6: { value: 5, text: "spine a" },
                o7: { value: 14, text: "left shoulder" },
                o8: { value: 39, text: "right shoulder" },
            }

            $.each(keys, function (i, item) {
                $('.optKeys').append($('<option>', {
                    value: item.value,
                    text: item.text
                }));
            });

            $.each(hitboxes, function (i, item) {
                $('.optHitboxes').append($('<option>', {
                    value: item.value,
                    text: item.text
                }));
            });
        })

        function onLoad() {
            // aimbot is the first tab so load it when the page is open
            loadElements(1);
        }

        function loadElements(tabIndex) {
            var byId = function (id) { return document.getElementById(id); };
            if (tabIndex == 1) {
                $.getJSON('http://192.168.1.200:2222/settings', function (json) {
                    let config = json.config
                    byId('aimbotEnabled').checked = config.aimbot.enabled
                    byId('aimbotSmooth').checked = config.aimbot.smooth_enabled

                    byId('aimbotFov').value = config.aimbot.fov
                    byId('fovNr').value = `${config.aimbot.fov.toFixed()} deg`

                    byId('aimbotSmoothFactor').value = config.aimbot.smooth_factor
                    byId('smoothFactorNr').value = config.aimbot.smooth_factor

                    byId('aimbotRcsEnabled').checked = config.aimbot.rcs_enabled

                    byId('aimbotSelectionSwitchOnKey').checked = config.aimbot.target_selection_switch_on_key
                    byId('aimbotSelectionSwitchKey').value = config.aimbot.target_selection_key
                    byId('aimbotMaxDistance').value = config.aimbot.maximum_distance
                    byId('aimMaxDistNr').value = `${config.aimbot.maximum_distance.toFixed()} m`
                    byId('aimbotOnFriends').value = config.aimbot.aim_on_friends
                    byId('aimbotVisCheck').value = config.aimbot.vis_check
                    byId('aimbotRandomAimSpot').value = config.aimbot.random_aim_spot
                    byId('aimbotOnDummies').value = false
                    byId('aimbotKey').value = config.aimbot.key
                    byId('aimbotPrimaryHitbox').value = config.aimbot.primary_hitbox
                    byId('aimbotSecondaryHitboxKey').value = config.aimbot.secondary_hitbox_key
                    byId('aimbotSecondaryHitbox').value = config.aimbot.secondary_hitbox
                    byId('aimbotTargetLock').checked = config.aimbot.target_lock
                });
            } else if (tabIndex == 2) {
                $.getJSON('http://192.168.1.200:2222/settings', function (json) {
                    let config = json.config
                    byId('visualEnabled').checked = config.visual.enabled
                    byId('visualItemEsp').checked = config.visual.item_esp
                    byId('visualHighlight').checked = config.visual.glow_esp
                    byId('visualHighlightAimTarget').checked = config.visual.aim_target_esp
                    byId('visualHighlightFriends').checked = config.visual.highlight_friends
                    byId('visualColoredHealth').checked = config.visual.color_health_based
                    byId('visualHealthBasedAlpha').value = config.visual.health_based_alpha * 100
                    byId('visualHealthAlphaNr').value = `${(config.visual.health_based_alpha * 100).toFixed()} %`

                    $(visualEspColor).spectrum({
                        color: `#${config.visual.esp_color}`
                    });
                    $(visualTargetColor).spectrum({
                        color: `#${config.visual.aimbot_target_color}`
                    });
                    $(visualDownedColor).spectrum({
                        color: `#${config.visual.downed_color}`
                    });
                    $(visualFriendColor).spectrum({
                        color: `#${config.visual.friend_color}`
                    });
                });
            }
        }
        function changeTab(i) {
            var aim = document.getElementById('aim');
            var aimTab = document.getElementById('aimbotTab');

            var esp = document.getElementById('esp');
            var espTab = document.getElementById('espTab');

            var misc = document.getElementById('misc');
            var miscTab = document.getElementById('miscTab');

            if (i == 1) {
                aim.style.display = 'inline'
                aimTab.classList = 'nav-item active'

                esp.style.display = 'none'
                espTab.className = 'nav-item'

                misc.style.display = 'none'
                misc.className = 'nav-item'
                loadElements(1)
            }
            else if (i == 2) {
                aim.style.display = 'none'
                aimTab.className = 'nav-item'

                esp.style.display = 'inline'
                espTab.className = 'nav-item active'

                misc.style.display = 'none'
                misc.className = 'nav-item'

                loadElements(2)
            }
            else if (i == 3) {
                aim.style.display = 'none'
                aimTab.className = 'nav-item'

                esp.style.display = 'none'
                espTab.className = 'nav-item'

                misc.style.display = 'inline'
                misc.className = 'nav-item active'
                loadElements(3)
            }
        }

        function onSaveLoad(s) {
            $.get(`http://192.168.1.200:2222/changed?t=fn&r=${s}`)
            loadElements(1)
        }

        function changedColor(name, id) {
            let clr = $(`#${id}`).spectrum('get').toHex8String().slice(1)
            $.get(`http://192.168.1.200:2222/changed?t=color&r=${name}&v=${clr}`)
        }
        function changed(type, name, value) {
            if (type == 'color') {
                type = 'value';
                value = $(`#${value}`).spectrum('get').toHex8String().slice(1)
            }
            $.get(`http://192.168.1.200:2222/changed?t=${type}&r=${name}&v=${value}`)
        }
    </script>
</body>

</html>